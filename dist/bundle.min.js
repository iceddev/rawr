var Rawr=(()=>{var K=Object.create;var L=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty;var Y=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),B=(e,t)=>{for(var r in t)L(e,r,{get:t[r],enumerable:!0})},I=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of U(t))!X.call(e,o)&&o!==r&&L(e,o,{get:()=>t[o],enumerable:!(n=Q(t,o))||n.enumerable});return e};var Z=(e,t,r)=>(r=e!=null?K(V(e)):{},I(t||!e||!e.__esModule?L(r,"default",{value:e,enumerable:!0}):r,e)),$=e=>I(L({},"__esModule",{value:!0}),e);var T=Y((se,C)=>{"use strict";var G=Object.prototype.hasOwnProperty,h="~";function _(){}Object.create&&(_.prototype=Object.create(null),new _().__proto__||(h=!1));function W(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function J(e,t,r,n,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var f=new W(r,n||e,o),i=h?h+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],f]:e._events[i].push(f):(e._events[i]=f,e._eventsCount++),e}function A(e,t){--e._eventsCount===0?e._events=new _:delete e._events[t]}function m(){this._events=new _,this._eventsCount=0}m.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)G.call(r,n)&&t.push(h?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};m.prototype.listeners=function(t){var r=h?h+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,f=n.length,i=new Array(f);o<f;o++)i[o]=n[o].fn;return i};m.prototype.listenerCount=function(t){var r=h?h+t:t,n=this._events[r];return n?n.fn?1:n.length:0};m.prototype.emit=function(t,r,n,o,f,i){var p=h?h+t:t;if(!this._events[p])return!1;var s=this._events[p],x=arguments.length,w,a;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),x){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,r),!0;case 3:return s.fn.call(s.context,r,n),!0;case 4:return s.fn.call(s.context,r,n,o),!0;case 5:return s.fn.call(s.context,r,n,o,f),!0;case 6:return s.fn.call(s.context,r,n,o,f,i),!0}for(a=1,w=new Array(x-1);a<x;a++)w[a-1]=arguments[a];s.fn.apply(s.context,w)}else{var j=s.length,g;for(a=0;a<j;a++)switch(s[a].once&&this.removeListener(t,s[a].fn,void 0,!0),x){case 1:s[a].fn.call(s[a].context);break;case 2:s[a].fn.call(s[a].context,r);break;case 3:s[a].fn.call(s[a].context,r,n);break;case 4:s[a].fn.call(s[a].context,r,n,o);break;default:if(!w)for(g=1,w=new Array(x-1);g<x;g++)w[g-1]=arguments[g];s[a].fn.apply(s[a].context,w)}}return!0};m.prototype.on=function(t,r,n){return J(this,t,r,n,!1)};m.prototype.once=function(t,r,n){return J(this,t,r,n,!0)};m.prototype.removeListener=function(t,r,n,o){var f=h?h+t:t;if(!this._events[f])return this;if(!r)return A(this,f),this;var i=this._events[f];if(i.fn)i.fn===r&&(!o||i.once)&&(!n||i.context===n)&&A(this,f);else{for(var p=0,s=[],x=i.length;p<x;p++)(i[p].fn!==r||o&&!i[p].once||n&&i[p].context!==n)&&s.push(i[p]);s.length?this._events[f]=s.length===1?s[0]:s:A(this,f)}return this};m.prototype.removeAllListeners=function(t){var r;return t?(r=h?h+t:t,this._events[r]&&A(this,r)):(this._events=new _,this._eventsCount=0),this};m.prototype.off=m.prototype.removeListener;m.prototype.addListener=m.prototype.on;m.prefixed=h;m.EventEmitter=m;typeof C<"u"&&(C.exports=m)});var ne={};B(ne,{default:()=>re});var R=Z(T(),1);var v=R.default;var b={};B(b,{mqtt:()=>S,socketio:()=>M,websocket:()=>N,worker:()=>k});function S({connection:e,subTopic:t,pubTopic:r,subscribe:n=!0}){let o=new v;return n&&e.subscribe(t),e.on("message",(f,i)=>{if(f===t)try{let p=JSON.parse(i.toString());(p.method||p.id&&("result"in p||"error"in p))&&o.emit("rpc",p)}catch{}}),o.send=f=>{e.publish(r,JSON.stringify(f))},o}function M({connection:e,subTopic:t,pubTopic:r}){let n=new v;return e.on(t,o=>{(o.method||o.id&&("result"in o||"error"in o))&&n.emit("rpc",o)}),n.send=o=>{e.emit(r,o)},n}function N(e,t=!1){let r=new v,n=async o=>{let f=o;if(o&&typeof o=="object"&&"data"in o&&(f=o.data,t&&f instanceof Blob&&(f=await new Response(f).text().catch(()=>null))),typeof Buffer<"u"&&Buffer.isBuffer(f)&&(f=f.toString()),typeof f=="string")try{let i=JSON.parse(f);(i.method||i.id&&("result"in i||"error"in i))&&r.emit("rpc",i)}catch{}};return typeof e.addEventListener=="function"?e.addEventListener("message",n):typeof e.on=="function"&&e.on("message",n),r.send=o=>{e.send(JSON.stringify(o))},r}function ee(e){let t=new v;return e.addEventListener("message",r=>{let{data:n}=r;n&&(n.method||n.id&&("result"in n||"error"in n))&&t.emit("rpc",n)}),t.send=(r,n)=>{e.postMessage(r,n?n.postMessageOptions:void 0)},t}function te(){let e=new v;return self.onmessage=t=>{let{data:r}=t;r&&(r.method||r.id&&("result"in r||"error"in r))&&e.emit("rpc",r)},e.send=(t,r)=>{self.postMessage(t,r?r.postMessageOptions:void 0)},e}function k(e){return e?ee(e):te()}function q({transport:e,timeout:t=0,handlers:r={},methods:n,idGenerator:o}){let f=0;n=n||r||{};let i={},p={},s=new v;s.on=s.on.bind(s),e.on("rpc",u=>{if(u.id){if(u.params&&p[u.method]){p[u.method](u);return}let d=i[u.id];return d?(d.timeoutId&&clearTimeout(d.timeoutId),delete i[u.id],u.error&&d.reject(u.error),d.resolve(u.result)):void 0}u.params.unshift(u.method),s.emit(...u.params)});function x(u,d){p[u]=c=>{Promise.resolve().then(()=>d.apply(this,c.params)).then(l=>{e.send({id:c.id,result:l})}).catch(l=>{let y={message:l.message};l.code&&(y.code=l.code),e.send({id:c.id,error:y})})}}Object.keys(n).forEach(u=>{x(u,n[u])});function w(u,d,c){let l=o?o():++f,y={jsonrpc:"2.0",method:u,params:d,id:l},E;(c.timeout||t)&&(E=setTimeout(()=>{if(i[l]){let P=new Error("RPC timeout");P.code=504,i[l].reject(P),delete i[l]}},c.timeout||t));let D=new Promise((P,F)=>{i[l]={resolve:P,reject:F,timeoutId:E}});return e.send(y,c),D}let a=new Proxy({},{get:(u,d)=>(...c)=>w(d,c,{})}),j=new Proxy({},{get:(u,d)=>(...c)=>{let l;if(c.length){let y=c.pop();y&&typeof y=="object"&&!Array.isArray(y)?l=y:c.push(y)}return w(d,c,l||{})}}),g=new Proxy({},{get:(u,d)=>(...c)=>{let l={jsonrpc:"2.0",method:d,params:c};e.send(l)}}),H=new Proxy({},{get:(u,d)=>(...c)=>{let l;if(c.length){let E=c.pop();E&&typeof E=="object"&&!Array.isArray(E)?l=E:c.push(E)}let y={jsonrpc:"2.0",method:d,params:c};e.send(y,l||{})}}),z=new Proxy({},{get:(u,d)=>c=>{s.on(d.substring(2),(...l)=>c.apply(c,l))}});return{methods:a,methodsExt:j,addHandler:x,notifications:z,notifiers:g,notifiersExt:H,transport:e}}q.transports=b;var O=q;O.EventEmitter=v;O.transports=b;globalThis.Rawr=O;var re=O;return $(ne);})();
